<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>刘方园&&田烩的婚礼邀请函</title>
    <link rel="stylesheet" href="wedding.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Alex+Brush&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Parisienne&display=swap" rel="stylesheet">

    <!--分享卡片标签-->

    <!-- 核心 SEO 标签 -->
    <meta name="description" content="诚邀您参加刘方园和田烩的婚礼，共赴这场浪漫之约～">
    <meta name="keywords" content="婚礼,邀请函,刘方园,田烩,结婚,浪漫">

    <!-- Open Graph (Facebook/通用分享) -->
    <meta property="og:title" content="刘方园&&田烩的婚礼邀请函">
    <meta property="og:description" content="诚邀您参加刘方园和田烩的婚礼，共赴这场浪漫之约～">
    <meta property="og:image" content="https://tzxljc.github.io/tianhui-liufangyuan/y_339A3095_1.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tzxljc.github.io/tianhui-liufangyuan/">

    <!-- 微信专用标签 -->
    <meta property="wechat:image" content="https://tzxljc.github.io/tianhui-liufangyuan/y_339A3095_1.jpg">
    <meta name="wechat-share-image" content="https://tzxljc.github.io/tianhui-liufangyuan/y_339A3095_1.jpg">
</head>

<body>

    <!--外层框架-->
    <div class="container">

        <div class="music-btn" id="musicBtn">
            &#127928;
        </div>

        <!--头部-->
        <header id="header">
            <h2>来自刘方园&&田烩的一封婚礼邀请函</h2>
        </header>

        <!--主体内容-->
        <main>
            <section>
                <p>
                    叮咚!<br />
                    💌您已收到来自刘方园和田烩的婚礼邀请函 💌
                    <br /><br />
                </p>
                <p>
                    当心动撞个满怀，当温柔有了归处<br />
                    我们终于要把"喜欢"升级成"一辈子"啦！<br />
                    诚邀各位亲友伙伴<br />
                    共赴这场充满烟火气的浪漫之约<br />
                    <br />
                </p>
            </section>

            <section class="couple-section">
                <!--groom-->
                <div class="couple-card">
                    <img src="y_339A3037_1.jpg" alt="新郎">
                    <div class="couple-text">
                        <p class="art-font">Groom</p>
                        <p class="role">新郎/</p>
                        <p class="name">刘方园</p>
                    </div>
                </div>
                <!--bride-->
                <div class="couple-card">
                    <img src="y_339A3067_1.jpg" alt="新娘">
                    <div class="couple-text">
                        <p class="art-font">Bride</p>
                        <p class="role">新娘/</p>
                        <p class="name">田烩</p>
                    </div>
                </div>
            </section>

            <br />

            <section>
                <p>
                    接下来请跟随我们的甜蜜足迹<br />
                    解锁从"我"到"我们"的浪漫旅程~<br />
                    （小提示：&#128071;下滑解锁更多甜蜜暴击~）<br />
                </p>
                <br />
                <div class="art-image-container">
                    <div class="art-image-wrapper">
                        <img src="y_339A2998_1.jpg" alt="甜蜜瞬间" class="art-image">
                    </div>
                    <div class="art-title">invitation</div>
                </div>
            </section>

            <section>
                <div>
                    <p>
                        爱情是最小单位的共产主义<br />
                        在我们的二人国度里<br />
                        没有阶级的划分，没有贫富的差距。<br /><br />
                    </p>
                    <p>
                        我们以“共同”为底色<br />
                        共享三餐四季的烟火、共筑灵魂同频的共鸣<br />
                        就像共产主义追求的共同富裕<br />
                        追求的是物质与精神的高度统一<br />
                        我们也在物质与精神的同频里<br />
                        把日子过成圆满的模样。<br /><br /><br />
                    </p>
                </div>
            </section>

            <section>
                <!--艺术图文模块-->
                <div class="art-photo-module">
                    <p class="art-text art-text-yes">Yes,</p>
                    <p class="art-text art-text-ido">I do.</p>

                    <img src="y_339A3095_1.jpg" class="module-photo-right">
                    <img src="y_339A3104_1.jpg" class="module-photo-left">
                </div>
            </section>

            <br /><br />

            <section>
                <div>
                    <h3>💫 关于我们的小剧场 💫</h3>
                    从初遇到相守<br />
                    每一段时光都写满了温柔与默契<br />
                    那些藏在日常里的小甜蜜<br />
                    构成了我们专属的爱情故事～<br /><br />
                </div>
                <div class="split-layout1">
                    <div class="split-text1">
                        <h4>【相恋】</h4>
                        是双向奔赴的甜蜜<br />
                        爱意在细碎的时光里慢慢扎根<br />
                        我们一起解锁了很多第一次<br />
                        一起把平淡的日子过成了诗<br />
                        <p class="split-slogan1">LOVE YOU</p>
                        <p class="split-slogan1">FOREVER</p>
                    </div>
                    <div class="split-img1">
                        <img src="y_339A3001_1.jpg" alt="相恋时光">
                    </div>
                </div>
                <div class="split-layout2">
                    <div class="split-img2">
                        <img src="y_339A3042_1.jpg" alt="相守时刻">
                    </div>
                    <div class="split-text2">
                        <p class="split-slogan2">LOVE NEVER</p>
                        <p class="split-slogan2">FAILS</p>
                        <h4>【相守】</h4>
                        是自然而然的决定<br />
                        从此，我们不仅是彼此的爱人<br />
                        更是并肩同行的伙伴<br />
                        这份双向奔赴的深情<br />
                        就是我们爱情最美好的见证<br />
                    </div>
                </div>
            </section>

            <br /><br /><br />

            <section>
                <div class="double-wrap">
                    <div class="double-text">
                        🌙 一个人可以走得很快，但两个人走更有意义<br />
                        是你把我的犹豫变成坚定，把我的孤单变成热闹<br />
                        双向奔赴的意义，就是“好巧，我也刚好喜欢你”<br />
                        这一次，喜欢和合适撞了个满怀，真好<br />
                    </div>
                    <br /><br />
                    <div class="double-img-container">
                        <img src="y_339A3313_1.jpg">
                        <img src="y_339A3255_1.jpg">
                    </div>
                </div>
            </section>

            <br /><br /><br />

            <section>
                <div>
                    <h3>&#128198; 重要日期</h3>
                    2026年2月12日~2月13日<br />
                    农历十二月二十五~二十六
                </div>
            </section>

            <br /><br />

            <section>
                <div class="countdown-container">
                    <!--倒计时-->
                    <div class="countdown-nums">
                        <div class="countdown-item">
                            <span id="days">00</span>
                            <p>天</p>
                        </div>
                        <div class="countdown-item">
                            <span id="hours">00</span>
                            <p>时</p>
                        </div>
                        <div class="countdown-item">
                            <span id="minutes">00</span>
                            <p>分</p>
                        </div>
                        <div class="countdown-item">
                            <span id="seconds">00</span>
                            <p>秒</p>
                        </div>
                    </div>
                    <!--右边图片-->
                    <div class="countdown-img">
                        <img src="y_339A3284_1.jpg">
                    </div>
                </div>
            </section>

            <br /><br /><br />

            <section>
                <div>
                    <h3>📍幸福坐标</h3>
                    <div class="address-section">
                        <!--外层flex容器:实现两列并排-->
                        <div class="address-list">
                            <!--第一个地址-->
                            <div class="address-item">
                                <div class="address-map">
                                    <img src="小方地图.png">
                                </div>
                                <div class="address-info">
                                    <a href="https://surl.amap.com/1Q3DtW61kaQH" target="_blank">
                                        <p>
                                            遵义市绥阳县坪乐镇顺河村<br />
                                            (点击导航)
                                        </p>
                                    </a>
                                </div>
                            </div>
                            <!--第二个地址-->
                            <div class="address-item">
                                <div class="address-map">
                                    <img src="烩地图.png">
                                </div>
                                <div class="address-info">
                                    <a href="https://www.amap.com/place/B03541917C" target="_blank">
                                        <p>
                                            遵义市红花岗区深溪镇大窝村<br />
                                            (点击导航)
                                        </p>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
            </section>

            <br /><br /><br />

            <section>
                <div>
                    <h3>💌 赴约小tips<br /><br /></h3>
                </div>
                <div>
                    <h4>【远程参与彩蛋】</h4>
                    若你暂被距离/琐事绊住脚步<br />
                    无需挂心——发送任意形式的祝福<br />
                    即可解锁「远程幸福贡献者」称号，我们会把这份牵挂妥善存档<br /><br />
                    <h4>【入场必备Buff】</h4>
                    赴约请携带「100% 松弛感+感知甜份的雷达」<br />
                    今日的现场没有"标准流程"，你只管带着舒展的状态来~<br /><br />
                    <h4>【画面捕捉图鉴】</h4>
                    现场已解锁「氛围感拍摄打卡点」<br />
                    自带「摆拍指令豁免权」，无需硬凹造型<br />
                    随手定格的每一帧，都是今天独一份的生动画面～
                </div>
                <div>
                    <div id="wedding-photo_wrap"></div>
                </div>
            </section>

            <section>
                <div id="ending">
                    <p>
                        🎊 我们的婚礼，因你而圆满 🎊<br />
                        不追求盛大奢华，只希望与最爱的家人朋友们<br />
                        一起分享这份喜悦，见证我们的幸福时刻<br />
                        期待与你，在充满爱的氛围里，共赴这场浪漫之约<br /><br />
                    </p>

                    &#128150; 感谢看到这里的你 &#128150;<br />
                    我们的爱情序章落笔收梢，满溢的幸福即将启程<br />
                    2026年2月13日，我们候你赴约<br />
                    一起见证“我”蜕变成“我们”的珍贵时刻<br />
                    共赴往后岁岁年年的崭新篇章<br />
                    盼你携着祝福而来，与我们一同定格这份圆满<br />
                </div>
            </section>
        </main>

    </div>

    <audio id="bg-music" loop preload="auto" src="刘人语 - 心跳的证明.mp3">
        <source src="刘人语 - 心跳的证明.mp3" type="audio/mp3">
    </audio>

    <script>
        // ========== 1. 初始化变量 ==========
        const bgMusic = document.getElementById('bg-music');
        const musicBtn = document.getElementById('musicBtn');
        const container = document.querySelector('.container');

        // 自动滚动配置
        let autoScrollActive = false;
        let isUserInteracting = false;
        let scrollInterval = null;
        let resumeTimer = null;
        let musicPlayed = false;
        let hasPlayedByScroll = false; // 标记是否通过滑动触发音乐播放

        // ========== 2. 音乐控制 ==========
        function setupMusic() {
            let isPlaying = false; // 初始暂停（适配微信）
            updateMusicButtonState(); // 初始化按钮样式

            // 点击/触摸按钮切换播放
            musicBtn.addEventListener('click', function (e) {
                e.stopPropagation();
                toggleMusic();
            });
            musicBtn.addEventListener('touchstart', function (e) {
                e.preventDefault();
                toggleMusic();
            }, { passive: false });

            // 核心：切换音乐播放/暂停
            function toggleMusic() {
                if (bgMusic.paused) {
                    bgMusic.muted = false;
                    bgMusic.play().then(() => {
                        isPlaying = true;
                        musicPlayed = true;
                        updateMusicButtonState();
                    }).catch(err => {
                        console.log('音乐播放失败:', err);
                        alert('请点击允许播放音乐');
                    });
                } else {
                    bgMusic.pause();
                    isPlaying = false;
                    updateMusicButtonState();
                }
            }

            // 更新音乐按钮样式
            function updateMusicButtonState() {
                if (bgMusic.paused) {
                    musicBtn.classList.remove('playing');
                    musicBtn.classList.add('paused');
                    musicBtn.innerHTML = '&#127928;';
                    musicBtn.title = '点击播放音乐';
                } else {
                    musicBtn.classList.add('playing');
                    musicBtn.classList.remove('paused');
                    musicBtn.innerHTML = '&#127928;';
                    musicBtn.title = '点击暂停音乐';
                }
            }

            // 监听音频状态变化
            bgMusic.addEventListener('play', () => {
                isPlaying = true;
                updateMusicButtonState();
            });
            bgMusic.addEventListener('pause', () => {
                isPlaying = false;
                updateMusicButtonState();
            });
            bgMusic.addEventListener('error', () => {
                console.log('音频加载错误');
                musicBtn.innerHTML = '❌';
                musicBtn.title = '音乐加载失败';
            });

            // 浏览器端自动播放（兼容非微信场景）
            if (!/(MicroMessenger)/i.test(navigator.userAgent)) {
                bgMusic.play().then(() => {
                    isPlaying = true;
                    musicPlayed = true;
                    updateMusicButtonState();
                }).catch(err => {
                    console.log('浏览器自动播放失败:', err);
                });
            }

            // 返回播放函数，供滚动事件调用
            return {
                playOnScroll: function () {
                    if (!hasPlayedByScroll && bgMusic.paused) {
                        bgMusic.play().then(() => {
                            isPlaying = true;
                            musicPlayed = true;
                            hasPlayedByScroll = true;
                            updateMusicButtonState();
                        }).catch(err => {
                            console.log('滑动触发播放失败:', err);
                            musicBtn.title = '点击播放音乐';
                        });
                    }
                }
            };
        }

        // ========== 3. 自动滚动 ==========
        function setupAutoScroll(musicHelper) {
            const SCROLL_SPEED = 15; // 像素/秒

            function startAutoScroll() {
                if (autoScrollActive) return;
                autoScrollActive = true;

                let lastTime = Date.now();
                function scrollFrame() {
                    if (!autoScrollActive || isUserInteracting) {
                        if (scrollInterval) clearInterval(scrollInterval);
                        scrollInterval = null;
                        return;
                    }

                    const currentTime = Date.now();
                    const deltaTime = currentTime - lastTime;
                    lastTime = currentTime;

                    const pixelsToScroll = (SCROLL_SPEED * deltaTime) / 1000;
                    const scrollRemaining = container.scrollHeight - container.clientHeight - container.scrollTop;

                    if (scrollRemaining <= 10) {
                        container.scrollTo({ top: 0, behavior: 'smooth' });
                        return;
                    }
                    container.scrollTop += pixelsToScroll;
                }

                if ('requestAnimationFrame' in window) {
                    function animateScroll() {
                        scrollFrame();
                        if (autoScrollActive && !isUserInteracting) requestAnimationFrame(animateScroll);
                    }
                    requestAnimationFrame(animateScroll);
                } else {
                    scrollInterval = setInterval(scrollFrame, 16);
                }
            }

            function stopAutoScroll() {
                autoScrollActive = false;
                if (scrollInterval) clearInterval(scrollInterval);
                scrollInterval = null;
            }

            // 合并滚动事件：同时处理「自动滚动暂停」和「音乐播放触发」
            function handleUserInteraction(e) {
                // 1. 触发音乐播放（仅第一次滑动）
                if (e.type === 'touchmove') {
                    musicHelper.playOnScroll();
                }

                // 2. 暂停自动滚动
                isUserInteracting = true;
                stopAutoScroll();

                if (resumeTimer) clearTimeout(resumeTimer);
                resumeTimer = setTimeout(() => {
                    isUserInteracting = false;
                    startAutoScroll();
                }, 3000);
            }

            // 只绑定一次touchmove事件（解决冲突核心）
            container.addEventListener('touchstart', handleUserInteraction, { passive: true });
            container.addEventListener('touchend', handleUserInteraction, { passive: true });
            container.addEventListener('touchmove', handleUserInteraction, { passive: true });
            container.addEventListener('wheel', handleUserInteraction, { passive: true });
            container.addEventListener('mousedown', handleUserInteraction);
            container.addEventListener('mousemove', handleUserInteraction);
            container.addEventListener('scroll', () => {
                if (!isUserInteracting) handleUserInteraction({ type: 'scroll' });
            });

            return { start: startAutoScroll, stop: stopAutoScroll };
        }

        // ========== 4. 倒计时逻辑 ==========
        function setupCountdown() {
            const weddingTime = new Date("2026-02-13 13:14:00").getTime();
            const daysEl = document.getElementById('days');
            const hoursEl = document.getElementById('hours');
            const minutesEl = document.getElementById('minutes');
            const secondsEl = document.getElementById('seconds');

            function updateCountdown() {
                const now = new Date().getTime();
                const diff = weddingTime - now;

                if (diff <= 0) {
                    daysEl.innerText = "00";
                    hoursEl.innerText = "00";
                    minutesEl.innerText = "00";
                    secondsEl.innerText = "00";
                    return;
                }

                const days = Math.floor(diff / 86400000);
                const hours = Math.floor((diff % 86400000) / 3600000);
                const minutes = Math.floor((diff % 3600000) / 60000);
                const seconds = Math.floor((diff % 60000) / 1000);

                daysEl.innerText = days.toString().padStart(2, '0');
                hoursEl.innerText = hours.toString().padStart(2, '0');
                minutesEl.innerText = minutes.toString().padStart(2, '0');
                secondsEl.innerText = seconds.toString().padStart(2, '0');
            }

            updateCountdown();
            setInterval(updateCountdown, 1000);
        }

        // ========== 5. 页面可见性处理 ==========
        function setupVisibilityHandler(autoScroll) {
            let hidden, visibilityChange;
            if (typeof document.hidden !== "undefined") {
                hidden = "hidden";
                visibilityChange = "visibilitychange";
            } else if (typeof document.msHidden !== "undefined") {
                hidden = "msHidden";
                visibilityChange = "msvisibilitychange";
            } else if (typeof document.webkitHidden !== "undefined") {
                hidden = "webkitHidden";
                visibilityChange = "webkitvisibilitychange";
            }

            function handleVisibilityChange() {
                if (document[hidden]) {
                    // 页面隐藏：暂停音乐和滚动
                    if (!bgMusic.paused) bgMusic.pause();
                    autoScroll.stop();
                } else {
                    // 页面显示：恢复音乐和滚动
                    if (musicPlayed && bgMusic.paused) {
                        bgMusic.play().catch(() => { });
                    }
                    if (!isUserInteracting) {
                        setTimeout(() => autoScroll.start(), 1000);
                    }
                }
            }

            if (typeof document.addEventListener !== "undefined" && hidden !== undefined) {
                document.addEventListener(visibilityChange, handleVisibilityChange, false);
            }
        }

        // ========== 6. 初始化 ==========
        function initAll() {
            // 初始化音乐功能
            const musicHelper = setupMusic();
            // 初始化自动滚动（传入音乐助手，合并事件）
            const autoScroll = setupAutoScroll(musicHelper);
            // 初始化倒计时
            setupCountdown();
            // 初始化页面可见性监听
            setupVisibilityHandler(autoScroll);

            // 页面加载完成后启动自动滚动
            window.addEventListener('load', () => {
                // 初始化按钮提示
                musicBtn.title = '下滑播放音乐 / 点击开关';
                // 延迟1秒启动自动滚动
                setTimeout(() => autoScroll.start(), 1000);
            });
        }

        // 页面加载完成后执行初始化
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initAll);
        } else {
            initAll();
        }
    </script>

</html>